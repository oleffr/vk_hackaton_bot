# Чат-бот для поддержки первокурсников
## Разработано в рамках хакатона «Цифровой вуз: создай удобный сервис для абитуриентов, студентов и преподавателей» от VK Education и Max
## Разработчики:
- **Ефремова Ольга** [Oleffr](https://github.com/oleffr)
- **Кузьмина Ксения** [KasyKuz](https://github.com/kasykuz)
- **Черникова Василиса** [Ogneva2Vasilisa](https://github.com/Ogneva2Vasilisa)

Этот проект позволяет создавать и обновлять базу знаний для RAG (Retrieval-Augmented Generation) системы на основе веб-страниц и PDF-файлов, а также запускатьв консоли чат-бота для работы с этой базой.

### Основные возможности

- **Создание или обновление базы знаний из PDF-файлов** (`pdfs` директория или указанный путь)
- **Создание или обновление базы знаний из URL** (`seed_urls.txt`)
- **Запуск чат-бота**, который использует базу знаний для ответов на вопросы
- **Справка по командам**, доступная через `main.py`

### Запуск решения через Docker
**Запуск и сборка**
```bash
sudo docker-compose up --build
```

**ВНИМАНИЕ! При запуске через Docker никакие другие команды не требуются. Ниже будет описан локальный запуск без Docker**

### Общий синтаксис локального запуска

```bash
python main.py <command> [options]
```

### Доступные команды

1. **update_pdf** – добавить или обновить PDF в базе знаний
   ```bash
   python main.py pdf --pdf_dir ./pdfs --out ./kb_output
   ```
   **Ньюансы:** 
   - Добавляет только новые PDF-файлы или новые чанки текста.
   - Сохраняет метаданные для каждого документа.
   - Использует LM Studio для генерации эмбеддингов.

2. **update_url** – добавить или обновить веб-страницы в базе знаний
   ```bash
   python main.py url --seeds ./seed_urls.txt --out ./kb_output --max_pages 200 --delay 0.1
   ```
   **Ньюансы:** 
   - Рекурсивно обходит страницы, ограничено `--max-pages`.
   - Игнорирует внешние домены, email, телефоны.
   - Обновляет существующую FAISS базу без дублирования чанков.
   - Создаёт/дополняет `urls.txt` с уникальными URL.

3. **chat** – запустить RAG чат-бота
   ```bash
   python main.py chat --out ./kb_output
   ```
   **Ньюансы:** 
   - Использует текущую FAISS базу.
   - Возвращает ответы с источниками (URL или PDF) по чанкам.
   - Поддерживает exit/выход/quit для завершения.

4. **help** – вывод справки
   ```bash
   python main.py help
   ```
   
## Установка зависимостей

```bash
pip install -r requirements.txt
```

## Пример полного рабочего процесса

```bash
# Обновляем базу из PDF
python main.py pdf --pdf_dir ./pdfs --out ./kb_outpu

# Обновляем базу из URL
python main.py url --seeds ./seed_urls.txt --out ./kb_output --max_pages 200 --delay 0.1

# Запускаем чат-бот
python main.py chat --out ./kb_output
```
